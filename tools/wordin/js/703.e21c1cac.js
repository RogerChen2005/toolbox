"use strict";(self["webpackChunkwordin"]=self["webpackChunkwordin"]||[]).push([[703],{8703:function(e,t,s){s.r(t),s.d(t,{default:function(){return q}});var l=s(3396),a=s(7139);const r=e=>((0,l.dD)("data-v-6fff33f7"),e=e(),(0,l.Cn)(),e),i=r((()=>(0,l._)("span",{class:"text-large font-600 mr-3"}," 背诵 ",-1))),o={key:0,id:"range",class:"container colbox"},n={id:"rangeselect",class:"card item"},d=r((()=>(0,l._)("div",{class:"title"},"选择测验范围：",-1))),c={style:{"font-size":"18px","font-weight":"500"}},h={id:"lastrecite",class:"card item"},u=r((()=>(0,l._)("div",{class:"title",style:{"font-size":"35px"}},"继续上一次的背诵",-1))),w={key:1,id:"test",class:"colbox"},g={style:{"flex-grow":"1"},class:"card"},m={id:"status"},k={key:1,class:"answer"},p={id:"explain"},f={id:"trans"},y={id:"add-to-box",class:"card"},_={class:"colbox para"},v=r((()=>(0,l._)("div",{class:"mid-text"},"分组:",-1))),C={class:"colbox para"},x=r((()=>(0,l._)("div",{class:"mid-text"},"单词本:",-1)));function S(e,t,s,r,S,b){const W=(0,l.up)("el-page-header"),z=(0,l.up)("el-checkbox"),I=(0,l.up)("el-checkbox-group"),U=(0,l.up)("el-button"),A=(0,l.up)("box-icon"),q=(0,l.up)("el-text"),D=(0,l.up)("el-option"),V=(0,l.up)("el-select");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(W,{style:{margin:"20px"},onBack:b.back_home},{content:(0,l.w5)((()=>[i])),_:1},8,["onBack"]),0===S.mode?((0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",n,[d,(0,l.Wm)(z,{modelValue:S.checkAll,"onUpdate:modelValue":t[0]||(t[0]=e=>S.checkAll=e),indeterminate:S.isIndeterminate,onChange:b.handleCheckAllChange,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("全选")])),_:1},8,["modelValue","indeterminate","onChange"]),(0,l.Wm)(I,{modelValue:S.checkedSets,"onUpdate:modelValue":t[1]||(t[1]=e=>S.checkedSets=e),onChange:b.handleChange},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(S.wordsets,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"set_radios",key:t},[(0,l._)("p",null,(0,a.zw)(t),1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e,(e=>((0,l.wg)(),(0,l.j4)(z,{class:"checkbox",key:e.id,label:e.id,size:"large",border:""},{default:(0,l.w5)((()=>[(0,l._)("div",c,(0,a.zw)(e.name),1)])),_:2},1032,["label"])))),128))])))),128))])),_:1},8,["modelValue","onChange"]),(0,l.Wm)(U,{style:{margin:"20px",width:"50%"},type:"primary",onClick:b.init},{default:(0,l.w5)((()=>[(0,l.Uk)("开始背诵")])),_:1},8,["onClick"])]),(0,l._)("div",h,[u,(0,l.Wm)(U,{style:{margin:"20px",width:"50%"},type:"primary",onClick:b.last_recite},{default:(0,l.w5)((()=>[(0,l.Uk)("开始背诵")])),_:1},8,["onClick"])])])):(0,l.kq)("",!0),1===S.mode?((0,l.wg)(),(0,l.iD)("div",w,[(0,l._)("div",g,[(0,l._)("div",m,"背诵进度: "+(0,a.zw)(S.current+1)+"/"+(0,a.zw)(S.total),1),(0,l._)("div",null,[S.current===S.answered?((0,l.wg)(),(0,l.iD)("textarea",{key:0,autofocus:"",id:"input",onInput:t[2]||(t[2]=(...e)=>b.change&&b.change(...e)),class:"answer",spellcheck:"false"},"\n            ",32)):(0,l.kq)("",!0),S.current<S.answered?((0,l.wg)(),(0,l.iD)("div",k,(0,a.zw)(S.word.word),1)):(0,l.kq)("",!0)]),(0,l._)("p",p,[S.current>0?((0,l.wg)(),(0,l.j4)(U,{key:0,onClick:b.prev},{default:(0,l.w5)((()=>[(0,l.Uk)("上一个")])),_:1},8,["onClick"])):(0,l.kq)("",!0),S.current<S.answered?((0,l.wg)(),(0,l.j4)(U,{key:1,onClick:b.next},{default:(0,l.w5)((()=>[(0,l.Uk)("下一个")])),_:1},8,["onClick"])):(0,l.kq)("",!0),S.current===S.answered?((0,l.wg)(),(0,l.j4)(U,{key:2,onClick:b.showAnswer},{default:(0,l.w5)((()=>[(0,l.Uk)("显示答案")])),_:1},8,["onClick"])):(0,l.kq)("",!0),S.current===S.answered?((0,l.wg)(),(0,l.j4)(U,{key:3,type:"warning",onClick:b.skip},{default:(0,l.w5)((()=>[(0,l.Uk)("跳过")])),_:1},8,["onClick"])):(0,l.kq)("",!0),(0,l.Wm)(U,{onClick:b.terminate,type:"danger"},{default:(0,l.w5)((()=>[(0,l.Uk)("停止背诵")])),_:1},8,["onClick"]),(0,l.Wm)(A,{color:"var(--text-color)",class:"btn",style:{"margin-left":"10px",translate:"0 4px"},onClick:b.audio_play,name:"volume-full"},null,8,["onClick"])]),(0,l._)("div",f,(0,a.zw)(S.word.type)+" "+(0,a.zw)(S.word.trans),1)]),(0,l._)("div",y,[(0,l.Wm)(q,{class:"mx-1",style:{"font-size":"35px","font-weight":"800"}},{default:(0,l.w5)((()=>[(0,l.Uk)("加入至")])),_:1}),(0,l._)("div",_,[v,(0,l.Wm)(V,{modelValue:S.set_class,"onUpdate:modelValue":t[3]||(t[3]=e=>S.set_class=e),class:"m-2",placeholder:"Select"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Object.keys(S.wordsets),(e=>((0,l.wg)(),(0,l.j4)(D,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l._)("div",C,[x,(0,l.Wm)(V,{modelValue:S.set_id,"onUpdate:modelValue":t[4]||(t[4]=e=>S.set_id=e),class:"m-2",placeholder:"Select"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(S.wordsets[S.set_class],(e=>((0,l.wg)(),(0,l.j4)(D,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l.Wm)(U,{onClick:b.add_to,type:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("添加")])),_:1},8,["onClick"])])])):(0,l.kq)("",!0)],64)}s(7658);var b=s(7178),W=s(6666),z=s(6e3),I={name:"WordRecite",data(){return{mode:0,allsets:[],wordsets:window.wordsets,checkedSets:[],isIndeterminate:!1,checkAll:!1,testWords:[],seq:[],total:0,current:0,answered:0,word:{},set_class:"",set_id:""}},methods:{handleCheckAllChange(e){this.checkedSets=e?this.allsets:[],this.isIndeterminate=!1},handleChange(e){console.log(this.checkedSets),this.checkAll=e.length===this.allsets.length,this.isIndeterminate=e.length>0&&e.length<this.allsets.length},init(){if(this.checkedSets.length<=0)return void(0,b.z8)({message:"请至少选择一个单词本",type:"error"});let e=(new Date).getTime();this.testWords=[];for(let s of this.checkedSets){let e=JSON.parse(localStorage.getItem(s));this.testWords=this.testWords.concat(...e)}if(localStorage.setItem("lastrecite",JSON.stringify({checkedSets:this.checkedSets,seed:e})),this.total=this.testWords.length,0===this.total)return void(0,b.z8)({message:"单词本为空",type:"error"});let t=Array.from(new Array(this.total).keys());for(let s=this.total-1;s>0;s--)[t[s],t[e%s]]=[t[e%s],t[s]];this.seq=t,this.current=0,this.answered=0,this.mode=1,(0,l.Y3)((()=>{this.show()}))},last_recite(){let e=JSON.parse(localStorage.getItem("lastrecite"));if(!e)return void(0,b.z8)({message:"没有记录",type:"error"});this.testWords=[];for(let l of e.checkedSets){let e=localStorage.getItem(l);if(!e)return void(0,b.z8)({message:"单词本不存在",type:"error"});this.testWords=this.testWords.concat(...JSON.parse(e))}this.total=this.testWords.length;let t=Array.from(new Array(this.total).keys());for(let l=this.total-1;l>0;l--)[t[l],t[e.seed%l]]=[t[e.seed%l],t[l]];this.seq=t;let s=Number(localStorage.getItem("lastcurrent"));this.current=s,this.answered=s,this.mode=1,(0,l.Y3)((()=>{this.show()}))},next(){if(this.current++,this.current===this.total)return this.mode=0,void(0,W.bM)({message:"您已完成所有单词的背诵",title:"Congratulations!",type:"success"});(0,l.Y3)((()=>{this.show()}))},skip(){(0,b.z8)({message:"已经跳过该词",type:"info"}),this.answered++,localStorage.setItem("lastcurrent",this.answered.toString()),this.next()},prev(){this.current--,this.show()},showAnswer(){(0,b.z8)(`答案：${this.word.word}`)},show(){if(this.word=this.testWords[this.seq[this.current]],console.log(this.word),this.current===this.answered){let e=document.getElementById("input");e.value="_".repeat(this.word.word.length),e.setSelectionRange(0,0),e.style.height=`${e.scrollHeight}px`}},change(){let e,t=document.getElementById("input"),s=t.value,l=s.indexOf("_");if(l==this.word.word.length){if(s.substring(0,s.length-1).toLowerCase()==this.word.word.toLowerCase())return(0,b.z8)({title:"Success",message:"正确",type:"success"}),this.answered++,localStorage.setItem("lastcurrent",this.answered.toString()),void this.next();(0,b.z8)({title:"Error",message:"错误",type:"error"}),e="_".repeat(this.word.word.length),l=0}else-1==l?e="_".repeat(this.word.word.length):(e=s.substring(0,l),e+="_".repeat(this.word.word.length-l));t.value=e,t.setSelectionRange(l,l),t.style.height=`${t.scrollHeight}px`,t.focus()},audio_play(){var e=new Audio("https://dict.youdao.com/dictvoice?audio="+this.word.word);e.play()},terminate(){z.T.confirm("确定要终止吗？").then((()=>{this.mode=0,(0,W.bM)({message:"背诵已终止",type:"info",title:"Terminate"})}))},back_home(){this.$router.push("/")},add_to(){let e=JSON.parse(localStorage.getItem(this.set_id));return e.push(this.word),localStorage.setItem(this.set_id,JSON.stringify(e)),(0,b.z8)({message:`已添加 ${this.word.word} (${this.word.type})`,type:"success"})}},created(){for(let e of Object.values(window.wordsets))for(let t of e)this.allsets.push(t.id);console.log(this.allsets)}},U=s(89);const A=(0,U.Z)(I,[["render",S],["__scopeId","data-v-6fff33f7"]]);var q=A}}]);
//# sourceMappingURL=703.e21c1cac.js.map